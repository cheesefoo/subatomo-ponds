<!DOCTYPE html>
<html lang="en">
<head>
    <title>Subaru Milestone Submission Form</title>
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <link href="upload.css" rel="stylesheet"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
    <script src="localization/language.js"></script>


    <link href="https://fonts.gstatic.com" rel="preconnect">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&family=Roboto&display=swap" rel="stylesheet">
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css"
          integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/0.8.2/css/flag-icon.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta2/dist/css/bootstrap-select.min.css"
          rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-select-country@4.0.0/dist/css/bootstrap-select-country.min.css"
          rel="stylesheet"/>


</head>

<body>

<div class="container main">
    <div class="dropdown justify-content-end">
        <button aria-expanded="false" class="btn btn-secondary btn-sm dropdown-toggle" data-bs-toggle="dropdown"
                id="dropdownMenuButton1" type="button">
            <a class="" id="dropdown-inner"></a>Language Selection
        </button>
        <ul aria-labelledby="dropdownMenuButton1" class="dropdown-menu">
            <li><a class="dropdown-item selectLang flag-icon flag-icon-us" href="#" lang="EN"></a>EN</li>
            <li><a class="dropdown-item selectLang flag-icon flag-icon-jp" href="#" lang="JP"></a>JP</li>
            <li><a class="dropdown-item selectLang flag-icon flag-icon-id" href="#" lang="ID"></a>ID</li>
            <li><a class="dropdown-item selectLang flag-icon flag-icon-es" href="#" lang="ES"></a>ES</li>
            <li><a class="dropdown-item selectLang flag-icon flag-icon-br" href="#" lang="PT"></a>PT</li>
            <li><a class="dropdown-item selectLang flag-icon flag-icon-kr" href="#" lang="KR"></a>KR</li>
            <li><a class="dropdown-item selectLang flag-icon flag-icon-nl" href="#" lang="NL"></a>NL</li>
        </ul>
    </div>
    <form
            action="https://script.google.com/macros/s/AKfycbxCWy0-NP1gjCIVw3JqbZMX7YD96j34coeSaXc91hAnGJbVuDmiRYrGR3UgCPzpfDg1-A/exec"
            id="form"
            method="post"
    >
        <div class="form-group row" id="data">
            <div class="displayName">
                <label for="name" text="u-1">Your display name. If left blank, your name will be (TBD)</label>
                <input class="input-sm col-xs-1" id="name" maxlength="16" name="displayName"/>
                <label for="message" text="u-2">Your congratulatory message for Subaru</label>
                <textarea class="textarea-sm col-xs-1" id="message" maxlength="128" name="message"></textarea>
            </div>
            <div class="contact">
                <label text="u-3">
                    Can we contact you if there are issues with your submission? This
                    is optional.</label>

                <div class="form-check form-check-inline">
                    <input checked class="form-check-input" data-bs-target=".collapseOne.show" data-bs-toggle="collapse"
                           id="inlineRadio1" name="canContact" type="radio"
                           value="no">
                    <label class="form-check-label" for="inlineRadio1" text="u-5">No</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" data-bs-target=".collapseOne:not(.show)" data-bs-toggle="collapse"
                           id="inlineRadio2"
                           name="canContact" type="radio" value="yes">
                    <label class="form-check-label" for="inlineRadio2" text="u-6">Yes</label>
                </div>
                <small text="u-4"> We will only contact you if there's a problem! </small>
            </div>

            <div class="collapseOne panel-collapse collapse">
                <div class="emailInput" id="emailInput">
                    <label for="email" text="u-7">Your email:</label>
                    <input id="email" name="email" type="email"/>
                </div>
                <div class="discordInput" id="discordInput">
                    <label for="discord" text="u-8">Your discord name and id:</label>
                    <span class="tooltip-item" text="u-9">Make sure your                        </span>
                    <a href="https://support.discord.com/hc/en-us/articles/217916488-Blocking-Privacy-Settings-"
                       text="u-10"> privacy settings</a>
                    <span text="u-11"> allow us to DM you.</span>

                </div>
                <input id="discord" name="discord" type="text"/>
            </div>


            <div id="soundSection">
                <label for="soundSelection" text="u-12">Sound to play when pressed:</label>
                <select form="form" id="soundSelection" name="soundSelection">
                    <option text="u-13" value="-1">Picked Randomly</option>
                    <option class="soundOption" text="u-14" value="0">Ajimaru Kazoo</option>
                    <option class="soundOption" text="u-15" value="1">Chuba Chuba Chuba</option>
                    <option class="soundOption" text="u-16" value="2">Chubaaaaaaa</option>
                    <option class="soundOption" text="u-17" value="3">here we go</option>
                    <option class="soundOption" text="u-18" value="4">Jakajakajanjan</option>
                    <option class="soundOption" text="u-19" value="5">morning shuba</option>
                    <option class="soundOption" text="u-20" value="6">Oyasumi (ASMR)</option>
                    <option class="soundOption" text="u-21" value="7">Quack Quack</option>
                    <option class="soundOption" text="u-22" value="8">secret</option>
                    <option class="soundOption" text="u-23" value="9">Shuba (x4)</option>
                    <option class="soundOption" text="u-24" value="10">Shuba!</option>
                    <option class="soundOption" text="u-25" value="11">Shushushushu</option>
                    <option class="soundOption" text="u-26" value="12">UN</option>
                </select>
            </div>

            <div id="soundButtons">
                <button class="soundButton" text="u-14" type="button" value="0">Ajimaru Kazoo</button>
                <button class="soundButton" text="u-15" type="button" value="1">Chuba Chuba Chuba</button>
                <button class="soundButton" text="u-16" type="button" value="2">mesu shuba</button>
                <button class="soundButton" text="u-17" type="button" value="3">here we go</button>
                <button class="soundButton" text="u-18" type="button" value="4">Jakajakajanjan</button>
                <button class="soundButton" text="u-19" type="button" value="5">morning shuba</button>
                <button class="soundButton" text="u-20" type="button" value="6">Oyasumi (ASMR)</button>
                <button class="soundButton" text="u-21" type="button" value="7">Quack Quack</button>
                <button class="soundButton" text="u-22" type="button" value="8">secret</button>
                <button class="soundButton" text="u-23" type="button" value="9">Shuba (x4)</button>
                <button class="soundButton" text="u-24" type="button" value="10">Shuba</button>
                <button class="soundButton" text="u-25" type="button" value="11">Shushushushu</button>
                <button class="soundButton" text="u-26" type="button" value="12">UN</button>
            </div>
            <div id="countrySection">
                <label for="country" text="u-31">Where are you from? (Optional)</label>
                <input id="country" maxlength="2" placeholder="Country Abbreviation"/>
                <!--                <select class="selectpicker countrypicker" data-default="ZZ" data-flag="true" data-live-search="true"-->
                <!--                        id="country">-->
                <!--                    <option value="abstain">I prefer not to answer</option>-->
                <!--                </select>-->

            </div>
            <div id="refererSection">
                <label for="referer">How did you hear about this project? </label>

                <select aria-label="referer" id="referer">
                    <option value="disc">A hololive fan Discord</option>
                    <option value="reddit">Reddit</option>
                    <option value="twitter">Twitter</option>
                    <option value="other">Other</option>
                </select>
            </div>
            <div id="upload">
                <label text="u-27">Upload your duck bellow</label>
                <input accept="image/png" class="form-control" id="uploadFile" name="file" type="file"/>
                <input class="form-control" id="submit" type="submit"/>
            </div>
        </div>


    </form>
    <audio autoplay id="player">
        <source id="mp3_src" src="" type="audio/mp3"/>
        Your browser does not support the audio element.
    </audio>
</div>
<div class="container" id="previewSection">
    <h3 class="mx-auto" id="previewText" text="u-29">Preview</h3>
    <div class="justify-content-end">
        <canvas height="200" id="animPreview1" style="visibility: hidden" width="200"></canvas>
        <canvas height="200" id="animPreview2" style="visibility: hidden" width="200"></canvas>
        <canvas height="200" id="animPreview1-flipped" style="visibility: hidden; transform:scale(-1,1)"
                width="200"></canvas>
        <canvas height="200" id="animPreview2-flipped" style="visibility: hidden; transform:scale(-1,1)"
                width="200"></canvas>
    </div>
</div>
<div id="submitting" style="display: none" text="u-28">Uploading duck...</div>

<script crossorigin="anonymous"
        integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4"
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta2/dist/js/bootstrap-select.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-select-country@4.0.0/dist/js/bootstrap-select-country.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-maxlength@1.10.1/dist/bootstrap-maxlength.min.js"></script>
<script src="upload.js"></script>
<script defer>

    $(function () {
        $(".countrypicker").countrypicker();
        $("#country").prepend("<option text='u-32' value='abstain' data-tokens='' data-countrycode='ZZ'></option>");
        loadJSON().then(loadTexts);
        // loadsounds().then(makeSoundButtons);
    });

    function loadTexts() {
        if (strings == null) {
            console.error("strings weren't loaded");
        }
        if (lang == null) {
            console.error("lang not set");
        }
        let tags = $("[text]");
        let texts = strings[lang]["UPLOAD"];
        console.log(texts);
        [...tags].forEach(function (t) {
            let textAttr = t.getAttribute("text");
            let index = textAttr.substr(2);

            t.textContent = texts[index];
        });
    }

    $(".selectLang").on("click", function () {
        lang = $(this).attr("lang");
        console.log(lang);
        localStorage["userLang"] = lang;
        // localStorage["userLang"] = $(this).attr("lang");
        // location.reload();
        loadTexts();
        changeDropdown();

    });

    function changeDropdown() {

        let dropdown = $("#dropdown-inner");
        dropdown.removeClass();
        dropdown.addClass("flag-icon");
        let cls = "flag-icon-";
        switch (lang) {
        case "EN":
            cls += "us";
            break;

        case "PT":
            cls += "br";
            break;
        default:
            cls += lang.toLowerCase();
            break;
        }
        dropdown.addClass(cls);
    }

    $("input[maxlength], textarea").maxlength({
        alwaysShow: true,
        warningClass: "form-text text-muted mt-1",
        limitReachedClass: "form-text text-muted mt-1",
    });

</script>
</body>
</html>
